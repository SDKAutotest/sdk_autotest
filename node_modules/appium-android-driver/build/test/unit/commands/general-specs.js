'use strict';

var _defineProperty = require('babel-runtime/helpers/define-property')['default'];

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _chaiAsPromised = require('chai-as-promised');

var _chaiAsPromised2 = _interopRequireDefault(_chaiAsPromised);

var _sinon = require('sinon');

var _sinon2 = _interopRequireDefault(_sinon);

var _ = require('../../..');

var _2 = _interopRequireDefault(_);

var _libCommandsGeneral = require('../../../lib/commands/general');

var _libAndroidHelpers = require('../../../lib/android-helpers');

var _libAndroidHelpers2 = _interopRequireDefault(_libAndroidHelpers);

var _appiumTestSupport = require('appium-test-support');

var _appiumSupport = require('appium-support');

var _appiumAndroidBootstrap = require('appium-android-bootstrap');

var _appiumAndroidBootstrap2 = _interopRequireDefault(_appiumAndroidBootstrap);

var _bluebird = require('bluebird');

var _bluebird2 = _interopRequireDefault(_bluebird);

var _appiumAdb = require('appium-adb');

var _appiumAdb2 = _interopRequireDefault(_appiumAdb);

_chai2['default'].should();
_chai2['default'].use(_chaiAsPromised2['default']);

var driver = undefined;
var sandbox = _sinon2['default'].createSandbox();
var expect = _chai2['default'].expect;

describe('General', function () {
  beforeEach(function () {
    driver = new _2['default']();
    driver.bootstrap = new _appiumAndroidBootstrap2['default']();
    driver.adb = new _appiumAdb2['default']();
    driver.caps = {};
    driver.opts = {};
  });
  afterEach(function () {
    sandbox.restore();
  });
  describe('keys', function () {
    it('should send keys via setText bootstrap command', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver.bootstrap, 'sendAction');
            driver.opts.unicodeKeyboard = true;
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.keys('keys'));

          case 4:
            driver.bootstrap.sendAction.calledWithExactly('setText', { text: 'keys', replace: false, unicodeKeyboard: true }).should.be['true'];

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should join keys if keys is array', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver.bootstrap, 'sendAction');
            driver.opts.unicodeKeyboard = false;
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.keys(['k', 'e', 'y', 's']));

          case 4:
            driver.bootstrap.sendAction.calledWithExactly('setText', { text: 'keys', replace: false }).should.be['true'];

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('getDeviceTime', function () {
    it('should return device time', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver.adb, 'shell');
            driver.adb.shell.returns(' 11:12 ');
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.getDeviceTime().should.become('11:12'));

          case 4:
            driver.adb.shell.calledWithExactly(['date']).should.be['true'];

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should thorws error if shell command failed', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver.adb, 'shell').throws();
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.getDeviceTime().should.be.rejectedWith('Could not capture'));

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('getPageSource', function () {
    it('should return page source', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver.bootstrap, 'sendAction').withArgs('source').returns('sources');
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.getPageSource());

          case 3:
            context$3$0.sent.should.be.equal('sources');

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('back', function () {
    it('should press back', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver.bootstrap, 'sendAction');
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.back());

          case 3:
            driver.bootstrap.sendAction.calledWithExactly('pressBack').should.be['true'];

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('isKeyboardShown', function () {
    it('should return true if the keyboard is shown', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.adb.isSoftKeyboardPresent = function () {
              return { isKeyboardShown: true, canCloseKeyboard: true };
            };
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.isKeyboardShown());

          case 3:
            context$3$0.sent.should.equal(true);

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should return false if the keyboard is not shown', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.adb.isSoftKeyboardPresent = function () {
              return { isKeyboardShown: false, canCloseKeyboard: true };
            };
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.isKeyboardShown());

          case 3:
            context$3$0.sent.should.equal(false);

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('hideKeyboard', function () {
    it('should hide keyboard via back command', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver, 'back');
            driver.adb.isSoftKeyboardPresent = function () {
              return { isKeyboardShown: true, canCloseKeyboard: true };
            };
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.hideKeyboard());

          case 4:
            driver.back.calledOnce.should.be['true'];

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should not call back command if can\'t close keyboard', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver, 'back');
            driver.adb.isSoftKeyboardPresent = function () {
              return { isKeyboardShown: true, canCloseKeyboard: false };
            };
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.hideKeyboard());

          case 4:
            driver.back.notCalled.should.be['true'];

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should throw an error if no keyboard is present', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.adb.isSoftKeyboardPresent = function () {
              return false;
            };
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.hideKeyboard().should.be.rejectedWith(/not present/));

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('openSettingsActivity', function () {
    it('should open settings activity', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver.adb, 'getFocusedPackageAndActivity').returns({ appPackage: 'pkg', appActivity: 'act' });
            sandbox.stub(driver.adb, 'shell');
            sandbox.stub(driver.adb, 'waitForNotActivity');
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.openSettingsActivity('set1'));

          case 5:
            driver.adb.shell.calledWithExactly(['am', 'start', '-a', 'android.settings.set1']).should.be['true'];
            driver.adb.waitForNotActivity.calledWithExactly('pkg', 'act', 5000).should.be['true'];

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('getWindowSize', function () {
    it('should get window size', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver.bootstrap, 'sendAction').withArgs('getDeviceSize').returns('size');
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.getWindowSize());

          case 3:
            context$3$0.sent.should.be.equal('size');

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('getWindowRect', function () {
    it('should get window size', function callee$2$0() {
      var rect;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver.bootstrap, 'sendAction').withArgs('getDeviceSize').returns({ width: 300, height: 400 });
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.getWindowRect());

          case 3:
            rect = context$3$0.sent;

            rect.width.should.be.equal(300);
            rect.height.should.be.equal(400);
            rect.x.should.be.equal(0);
            rect.y.should.be.equal(0);

          case 8:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('getCurrentActivity', function () {
    it('should get current activity', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver.adb, 'getFocusedPackageAndActivity').returns({ appActivity: 'act' });
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.getCurrentActivity().should.eventually.be.equal('act'));

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('getCurrentPackage', function () {
    it('should get current activity', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver.adb, 'getFocusedPackageAndActivity').returns({ appPackage: 'pkg' });
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.getCurrentPackage().should.eventually.equal('pkg'));

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('isAppInstalled', function () {
    it('should return true if app is installed', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver.adb, 'isAppInstalled').withArgs('pkg').returns(true);
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.isAppInstalled('pkg'));

          case 3:
            context$3$0.sent.should.be['true'];

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('removeApp', function () {
    it('should remove app', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver.adb, 'uninstallApk').withArgs('pkg').returns(true);
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.removeApp('pkg'));

          case 3:
            context$3$0.sent.should.be['true'];

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('installApp', function () {
    it('should install app', function callee$2$0() {
      var app;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            app = 'app.apk';

            sandbox.stub(driver.helpers, 'configureApp').withArgs(app, '.apk').returns(app);
            sandbox.stub(_appiumSupport.fs, 'rimraf').returns();
            sandbox.stub(driver.adb, 'install').returns(true);
            context$3$0.next = 6;
            return _regeneratorRuntime.awrap(driver.installApp(app));

          case 6:
            driver.helpers.configureApp.calledOnce.should.be['true'];
            _appiumSupport.fs.rimraf.notCalled.should.be['true'];
            driver.adb.install.calledOnce.should.be['true'];

          case 9:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should throw an error if APK does not exist', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.installApp('non/existent/app.apk').should.be.rejectedWith(/does not exist or is not accessible/));

          case 2:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('background', function () {
    it('should bring app to background and back', function callee$2$0() {
      var appPackage, appActivity;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            appPackage = 'wpkg';
            appActivity = 'wacv';

            driver.opts = { appPackage: appPackage, appActivity: appActivity, intentAction: 'act',
              intentCategory: 'cat', intentFlags: 'flgs',
              optionalIntentArguments: 'opt' };
            sandbox.stub(driver.adb, 'goToHome');
            sandbox.stub(driver.adb, 'getFocusedPackageAndActivity').returns({ appPackage: appPackage, appActivity: appActivity });
            sandbox.stub(_bluebird2['default'], 'delay');
            sandbox.stub(driver.adb, 'startApp');
            sandbox.stub(driver, 'activateApp');
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.background(10));

          case 10:
            driver.adb.getFocusedPackageAndActivity.calledOnce.should.be['true'];
            driver.adb.goToHome.calledOnce.should.be['true'];
            _bluebird2['default'].delay.calledWithExactly(10000).should.be['true'];
            driver.activateApp.calledWithExactly(appPackage).should.be['true'];
            driver.adb.startApp.notCalled.should.be['true'];

          case 15:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should bring app to background and back if started after session init', function callee$2$0() {
      var appPackage, appActivity, params;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            appPackage = 'newpkg';
            appActivity = 'newacv';

            driver.opts = { appPackage: 'pkg', appActivity: 'acv', intentAction: 'act',
              intentCategory: 'cat', intentFlags: 'flgs',
              optionalIntentArguments: 'opt' };
            params = { pkg: appPackage, activity: appActivity, action: 'act', category: 'cat',
              flags: 'flgs', waitPkg: 'wpkg', waitActivity: 'wacv',
              optionalIntentArguments: 'opt', stopApp: false };

            driver._cachedActivityArgs = _defineProperty({}, appPackage + '/' + appActivity, params);
            sandbox.stub(driver.adb, 'goToHome');
            sandbox.stub(driver.adb, 'getFocusedPackageAndActivity').returns({ appPackage: appPackage, appActivity: appActivity });
            sandbox.stub(_bluebird2['default'], 'delay');
            sandbox.stub(driver.adb, 'startApp');
            sandbox.stub(driver, 'activateApp');
            context$3$0.next = 12;
            return _regeneratorRuntime.awrap(driver.background(10));

          case 12:
            driver.adb.getFocusedPackageAndActivity.calledOnce.should.be['true'];
            driver.adb.goToHome.calledOnce.should.be['true'];
            _bluebird2['default'].delay.calledWithExactly(10000).should.be['true'];
            driver.adb.startApp.calledWithExactly(params).should.be['true'];
            driver.activateApp.notCalled.should.be['true'];

          case 17:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should bring app to background and back if waiting for other pkg / activity', function callee$2$0() {
      var appPackage, appActivity, appWaitPackage, appWaitActivity;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            appPackage = 'somepkg';
            appActivity = 'someacv';
            appWaitPackage = 'somewaitpkg';
            appWaitActivity = 'somewaitacv';

            driver.opts = { appPackage: appPackage, appActivity: appActivity, appWaitPackage: appWaitPackage, appWaitActivity: appWaitActivity,
              intentAction: 'act', intentCategory: 'cat',
              intentFlags: 'flgs', optionalIntentArguments: 'opt',
              stopApp: false };
            sandbox.stub(driver.adb, 'goToHome');
            sandbox.stub(driver.adb, 'getFocusedPackageAndActivity').returns({ appPackage: appWaitPackage, appActivity: appWaitActivity });
            sandbox.stub(_bluebird2['default'], 'delay');
            sandbox.stub(driver.adb, 'startApp');
            sandbox.stub(driver, 'activateApp');
            context$3$0.next = 12;
            return _regeneratorRuntime.awrap(driver.background(10));

          case 12:
            driver.adb.getFocusedPackageAndActivity.calledOnce.should.be['true'];
            driver.adb.goToHome.calledOnce.should.be['true'];
            _bluebird2['default'].delay.calledWithExactly(10000).should.be['true'];
            driver.activateApp.calledWithExactly(appWaitPackage).should.be['true'];
            driver.adb.startApp.notCalled.should.be['true'];

          case 17:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should not bring app back if seconds are negative', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver.adb, 'goToHome');
            sandbox.stub(driver.adb, 'startApp');
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.background(-1));

          case 4:
            driver.adb.goToHome.calledOnce.should.be['true'];
            driver.adb.startApp.notCalled.should.be['true'];

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('getStrings', (0, _appiumTestSupport.withMocks)({ helpers: _libAndroidHelpers2['default'] }, function (mocks) {
    it('should return app strings', function callee$2$0() {
      var strings;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.bootstrap.sendAction = function () {
              return '';
            };
            mocks.helpers.expects("pushStrings").returns({ test: 'en_value' });
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.getStrings('en'));

          case 4:
            strings = context$3$0.sent;

            strings.test.should.equal('en_value');
            mocks.helpers.verify();

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should return cached app strings for the specified language', function callee$2$0() {
      var strings;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.adb.getDeviceLanguage = function () {
              return 'en';
            };
            driver.apkStrings.en = { test: 'en_value' };
            driver.apkStrings.fr = { test: 'fr_value' };
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getStrings('fr'));

          case 5:
            strings = context$3$0.sent;

            strings.test.should.equal('fr_value');

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should return cached app strings for the device language', function callee$2$0() {
      var strings;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.adb.getDeviceLanguage = function () {
              return 'en';
            };
            driver.apkStrings.en = { test: 'en_value' };
            driver.apkStrings.fr = { test: 'fr_value' };
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getStrings());

          case 5:
            strings = context$3$0.sent;

            strings.test.should.equal('en_value');

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  }));
  describe('launchApp', function () {
    it('should init and start app', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            sandbox.stub(driver, 'initAUT');
            sandbox.stub(driver, 'startAUT');
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.launchApp());

          case 4:
            driver.initAUT.calledOnce.should.be['true'];
            driver.startAUT.calledOnce.should.be['true'];

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('startActivity', function () {
    var params = undefined;
    beforeEach(function () {
      params = { pkg: 'pkg', activity: 'act', waitPkg: 'wpkg', waitActivity: 'wact',
        action: 'act', category: 'cat', flags: 'flgs', optionalIntentArguments: 'opt' };
      sandbox.stub(driver.adb, 'startApp');
    });
    it('should start activity', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            params.optionalIntentArguments = 'opt';
            params.stopApp = false;
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.startActivity('pkg', 'act', 'wpkg', 'wact', 'act', 'cat', 'flgs', 'opt', true));

          case 4:
            driver.adb.startApp.calledWithExactly(params).should.be['true'];

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should use dontStopAppOnReset from opts if it is not passed as param', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.opts.dontStopAppOnReset = true;
            params.stopApp = false;
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.startActivity('pkg', 'act', 'wpkg', 'wact', 'act', 'cat', 'flgs', 'opt'));

          case 4:
            driver.adb.startApp.calledWithExactly(params).should.be['true'];

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should use appPackage and appActivity if appWaitPackage and appWaitActivity are undefined', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            params.waitPkg = 'pkg';
            params.waitActivity = 'act';
            params.stopApp = true;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.startActivity('pkg', 'act', null, null, 'act', 'cat', 'flgs', 'opt', false));

          case 5:
            driver.adb.startApp.calledWithExactly(params).should.be['true'];

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('reset', function () {
    it('should reset app via reinstall if fullReset is true', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.opts.fullReset = true;
            driver.opts.appPackage = 'pkg';
            sandbox.stub(driver, 'startAUT').returns('aut');
            sandbox.stub(_libAndroidHelpers2['default'], 'resetApp').returns(undefined);
            context$3$0.next = 6;
            return _regeneratorRuntime.awrap(driver.reset().should.eventually.be.equal('aut'));

          case 6:
            _libAndroidHelpers2['default'].resetApp.calledWith(driver.adb).should.be['true'];
            driver.startAUT.calledOnce.should.be['true'];

          case 8:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should do fast reset if fullReset is false', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.opts.fullReset = false;
            driver.opts.appPackage = 'pkg';
            sandbox.stub(_libAndroidHelpers2['default'], 'resetApp').returns(undefined);
            sandbox.stub(driver, 'startAUT').returns('aut');
            context$3$0.next = 6;
            return _regeneratorRuntime.awrap(driver.reset().should.eventually.be.equal('aut'));

          case 6:
            _libAndroidHelpers2['default'].resetApp.calledWith(driver.adb).should.be['true'];
            driver.startAUT.calledOnce.should.be['true'];
            expect(driver.curContext).to.eql('NATIVE_APP');

          case 9:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('startAUT', function () {
    it('should start AUT', function callee$2$0() {
      var params;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.opts = {
              appPackage: 'pkg',
              appActivity: 'act',
              intentAction: 'actn',
              intentCategory: 'cat',
              intentFlags: 'flgs',
              appWaitPackage: 'wpkg',
              appWaitActivity: 'wact',
              appWaitDuration: 'wdur',
              optionalIntentArguments: 'opt',
              userProfile: 1
            };
            params = {
              pkg: 'pkg',
              activity: 'act',
              action: 'actn',
              category: 'cat',
              flags: 'flgs',
              waitPkg: 'wpkg',
              waitActivity: 'wact',
              waitDuration: 'wdur',
              optionalIntentArguments: 'opt',
              stopApp: false,
              user: 1
            };

            driver.opts.dontStopAppOnReset = true;
            params.stopApp = false;
            sandbox.stub(driver.adb, 'startApp');
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.startAUT());

          case 7:
            driver.adb.startApp.calledWithExactly(params).should.be['true'];

          case 8:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('setUrl', function () {
    it('should set url', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.opts = { appPackage: 'pkg' };
            sandbox.stub(driver.adb, 'startUri');
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.setUrl('url'));

          case 4:
            driver.adb.startUri.calledWithExactly('url', 'pkg').should.be['true'];

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('closeApp', function () {
    it('should close app', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.opts = { appPackage: 'pkg' };
            sandbox.stub(driver.adb, 'forceStop');
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.closeApp());

          case 4:
            driver.adb.forceStop.calledWithExactly('pkg').should.be['true'];

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('getDisplayDensity', function () {
    it('should return the display density of a device', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.adb.shell = function () {
              return '123';
            };
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.getDisplayDensity());

          case 3:
            context$3$0.sent.should.equal(123);

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should return the display density of an emulator', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.adb.shell = function (cmd) {
              var joinedCmd = cmd.join(' ');
              if (joinedCmd.indexOf('ro.sf') !== -1) {
                // device property look up
                return '';
              } else if (joinedCmd.indexOf('qemu.sf') !== -1) {
                // emulator property look up
                return '456';
              }
              return '';
            };
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.getDisplayDensity());

          case 3:
            context$3$0.sent.should.equal(456);

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should throw an error if the display density property can\'t be found', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.adb.shell = function () {
              return '';
            };
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.getDisplayDensity().should.be.rejectedWith(/Failed to get display density property/));

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should throw and error if the display density is not a number', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver.adb.shell = function () {
              return 'abc';
            };
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.getDisplayDensity().should.be.rejectedWith(/Failed to get display density property/));

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('parseSurfaceLine', function () {
    it('should return visible true if the surface is visible', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            (0, _libCommandsGeneral.parseSurfaceLine)('shown=true rect=1 1 1 1').should.be.eql({
              visible: true,
              x: 1,
              y: 1,
              width: 1,
              height: 1
            });

          case 1:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should return visible false if the surface is not visible', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            (0, _libCommandsGeneral.parseSurfaceLine)('shown=false rect=1 1 1 1').should.be.eql({
              visible: false,
              x: 1,
              y: 1,
              width: 1,
              height: 1
            });

          case 1:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should return the parsed surface bounds', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            (0, _libCommandsGeneral.parseSurfaceLine)('shown=true rect=(1.0,2.0) 3.0 x 4.0').should.be.eql({
              visible: true,
              x: 1,
              y: 2,
              width: 3,
              height: 4
            });

          case 1:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });

  // these are used for both parseWindows and getSystemBars tests
  var validWindowOutput = ['  Window #1 Derp', '    stuff', '      Surface: derp shown=false lalalala rect=(9.0,8.0) 7.0 x 6.0', '    more stuff', '  Window #2 StatusBar', '    blah blah blah', '      Surface: blah blah shown=true blah blah rect=(1.0,2.0) 3.0 x 4.0', '    blah blah blah', '  Window #3 NavigationBar', '    womp womp', '      Surface: blah blah shown=false womp womp rect=(5.0,6.0) 50.0 x 60.0', '    qwerty asd zxc'].join('\n');
  var validSystemBars = {
    statusBar: { visible: true, x: 1, y: 2, width: 3, height: 4 },
    navigationBar: { visible: false, x: 5, y: 6, width: 50, height: 60 }
  };

  describe('parseWindows', function () {
    it('should throw an error if the status bar info wasn\'t found', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            expect(function () {
              (0, _libCommandsGeneral.parseWindows)('');
            }).to['throw'](Error, /Failed to parse status bar information./);

          case 1:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should throw an error if the navigation bar info wasn\'t found', function callee$2$0() {
      var windowOutput;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            windowOutput = ['  Window #1 StatusBar', '    blah blah blah', '      Surface: blah blah shown=true blah blah rect=(1.0,2.0) 3.0 x 4.0', '    blah blah blah'].join('\n');

            expect(function () {
              (0, _libCommandsGeneral.parseWindows)(windowOutput);
            }).to['throw'](Error, /Failed to parse navigation bar information./);

          case 2:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should return status and navigation bar info when both are given', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            (0, _libCommandsGeneral.parseWindows)(validWindowOutput).should.be.eql(validSystemBars);

          case 1:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('getSystemBars', function () {
    it('should throw an error if there\'s no window manager output', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver = new _2['default']();
            driver.adb = {};
            driver.adb.shell = function () {
              return '';
            };
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getSystemBars().should.be.rejectedWith(/Did not get window manager output./));

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should return the parsed system bar info', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            driver = new _2['default']();
            driver.adb = {};
            driver.adb.shell = function () {
              return validWindowOutput;
            };
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getSystemBars());

          case 5:
            context$3$0.t0 = validSystemBars;
            context$3$0.sent.should.be.eql(context$3$0.t0);

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
});
//eslint-disable-line
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvdW5pdC9jb21tYW5kcy9nZW5lcmFsLXNwZWNzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O29CQUFpQixNQUFNOzs7OzhCQUNJLGtCQUFrQjs7OztxQkFDM0IsT0FBTzs7OztnQkFDQyxVQUFVOzs7O2tDQUNXLCtCQUErQjs7aUNBQzFELDhCQUE4Qjs7OztpQ0FDeEIscUJBQXFCOzs2QkFDNUIsZ0JBQWdCOztzQ0FDYiwwQkFBMEI7Ozs7d0JBQ2xDLFVBQVU7Ozs7eUJBQ1IsWUFBWTs7OztBQUc1QixrQkFBSyxNQUFNLEVBQUUsQ0FBQztBQUNkLGtCQUFLLEdBQUcsNkJBQWdCLENBQUM7O0FBRXpCLElBQUksTUFBTSxZQUFBLENBQUM7QUFDWCxJQUFJLE9BQU8sR0FBRyxtQkFBTSxhQUFhLEVBQUUsQ0FBQztBQUNwQyxJQUFJLE1BQU0sR0FBRyxrQkFBSyxNQUFNLENBQUM7O0FBRXpCLFFBQVEsQ0FBQyxTQUFTLEVBQUUsWUFBWTtBQUM5QixZQUFVLENBQUMsWUFBWTtBQUNyQixVQUFNLEdBQUcsbUJBQW1CLENBQUM7QUFDN0IsVUFBTSxDQUFDLFNBQVMsR0FBRyx5Q0FBZSxDQUFDO0FBQ25DLFVBQU0sQ0FBQyxHQUFHLEdBQUcsNEJBQVMsQ0FBQztBQUN2QixVQUFNLENBQUMsSUFBSSxHQUFHLEVBQUUsQ0FBQztBQUNqQixVQUFNLENBQUMsSUFBSSxHQUFHLEVBQUUsQ0FBQztHQUNsQixDQUFDLENBQUM7QUFDSCxXQUFTLENBQUMsWUFBWTtBQUNwQixXQUFPLENBQUMsT0FBTyxFQUFFLENBQUM7R0FDbkIsQ0FBQyxDQUFDO0FBQ0gsVUFBUSxDQUFDLE1BQU0sRUFBRSxZQUFZO0FBQzNCLE1BQUUsQ0FBQyxnREFBZ0QsRUFBRTs7OztBQUNuRCxtQkFBTyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxFQUFFLFlBQVksQ0FBQyxDQUFDO0FBQzdDLGtCQUFNLENBQUMsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUM7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dCI6WyJpbXBvcnQgY2hhaSBmcm9tICdjaGFpJztcbmltcG9ydCBjaGFpQXNQcm9taXNlZCBmcm9tICdjaGFpLWFzLXByb21pc2VkJztcbmltcG9ydCBzaW5vbiBmcm9tICdzaW5vbic7XG5pbXBvcnQgQW5kcm9pZERyaXZlciBmcm9tICcuLi8uLi8uLic7XG5pbXBvcnQgeyBwYXJzZVN1cmZhY2VMaW5lLCBwYXJzZVdpbmRvd3MgfSBmcm9tICcuLi8uLi8uLi9saWIvY29tbWFuZHMvZ2VuZXJhbCc7XG5pbXBvcnQgaGVscGVycyBmcm9tICcuLi8uLi8uLi9saWIvYW5kcm9pZC1oZWxwZXJzJztcbmltcG9ydCB7IHdpdGhNb2NrcyB9IGZyb20gJ2FwcGl1bS10ZXN0LXN1cHBvcnQnO1xuaW1wb3J0IHsgZnMgfSBmcm9tICdhcHBpdW0tc3VwcG9ydCc7XG5pbXBvcnQgQm9vdHN0cmFwIGZyb20gJ2FwcGl1bS1hbmRyb2lkLWJvb3RzdHJhcCc7XG5pbXBvcnQgQiBmcm9tICdibHVlYmlyZCc7XG5pbXBvcnQgQURCIGZyb20gJ2FwcGl1bS1hZGInO1xuXG5cbmNoYWkuc2hvdWxkKCk7XG5jaGFpLnVzZShjaGFpQXNQcm9taXNlZCk7XG5cbmxldCBkcml2ZXI7XG5sZXQgc2FuZGJveCA9IHNpbm9uLmNyZWF0ZVNhbmRib3goKTtcbmxldCBleHBlY3QgPSBjaGFpLmV4cGVjdDtcblxuZGVzY3JpYmUoJ0dlbmVyYWwnLCBmdW5jdGlvbiAoKSB7XG4gIGJlZm9yZUVhY2goZnVuY3Rpb24gKCkge1xuICAgIGRyaXZlciA9IG5ldyBBbmRyb2lkRHJpdmVyKCk7XG4gICAgZHJpdmVyLmJvb3RzdHJhcCA9IG5ldyBCb290c3RyYXAoKTtcbiAgICBkcml2ZXIuYWRiID0gbmV3IEFEQigpO1xuICAgIGRyaXZlci5jYXBzID0ge307XG4gICAgZHJpdmVyLm9wdHMgPSB7fTtcbiAgfSk7XG4gIGFmdGVyRWFjaChmdW5jdGlvbiAoKSB7XG4gICAgc2FuZGJveC5yZXN0b3JlKCk7XG4gIH0pO1xuICBkZXNjcmliZSgna2V5cycsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIHNlbmQga2V5cyB2aWEgc2V0VGV4dCBib290c3RyYXAgY29tbWFuZCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIHNhbmRib3guc3R1Yihkcml2ZXIuYm9vdHN0cmFwLCAnc2VuZEFjdGlvbicpO1xuICAgICAgZHJpdmVyLm9wdHMudW5pY29kZUtleWJvYXJkID0gdHJ1ZTtcbiAgICAgIGF3YWl0IGRyaXZlci5rZXlzKCdrZXlzJyk7XG4gICAgICBkcml2ZXIuYm9vdHN0cmFwLnNlbmRBY3Rpb25cbiAgICAgICAgLmNhbGxlZFdpdGhFeGFjdGx5KCdzZXRUZXh0JyxcbiAgICAgICAgICB7dGV4dDogJ2tleXMnLCByZXBsYWNlOiBmYWxzZSwgdW5pY29kZUtleWJvYXJkOiB0cnVlfSlcbiAgICAgICAgLnNob3VsZC5iZS50cnVlO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgam9pbiBrZXlzIGlmIGtleXMgaXMgYXJyYXknLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmJvb3RzdHJhcCwgJ3NlbmRBY3Rpb24nKTtcbiAgICAgIGRyaXZlci5vcHRzLnVuaWNvZGVLZXlib2FyZCA9IGZhbHNlO1xuICAgICAgYXdhaXQgZHJpdmVyLmtleXMoWydrJywgJ2UnLCAneScsICdzJ10pO1xuICAgICAgZHJpdmVyLmJvb3RzdHJhcC5zZW5kQWN0aW9uXG4gICAgICAgIC5jYWxsZWRXaXRoRXhhY3RseSgnc2V0VGV4dCcsIHt0ZXh0OiAna2V5cycsIHJlcGxhY2U6IGZhbHNlfSlcbiAgICAgICAgLnNob3VsZC5iZS50cnVlO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ2dldERldmljZVRpbWUnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZGV2aWNlIHRpbWUnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmFkYiwgJ3NoZWxsJyk7XG4gICAgICBkcml2ZXIuYWRiLnNoZWxsLnJldHVybnMoJyAxMToxMiAnKTtcbiAgICAgIGF3YWl0IGRyaXZlci5nZXREZXZpY2VUaW1lKCkuc2hvdWxkLmJlY29tZSgnMTE6MTInKTtcbiAgICAgIGRyaXZlci5hZGIuc2hlbGwuY2FsbGVkV2l0aEV4YWN0bHkoWydkYXRlJ10pLnNob3VsZC5iZS50cnVlO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdGhvcndzIGVycm9yIGlmIHNoZWxsIGNvbW1hbmQgZmFpbGVkJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlci5hZGIsICdzaGVsbCcpLnRocm93cygpO1xuICAgICAgYXdhaXQgZHJpdmVyLmdldERldmljZVRpbWUoKS5zaG91bGQuYmUucmVqZWN0ZWRXaXRoKCdDb3VsZCBub3QgY2FwdHVyZScpO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ2dldFBhZ2VTb3VyY2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gcGFnZSBzb3VyY2UnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmJvb3RzdHJhcCwgJ3NlbmRBY3Rpb24nKS53aXRoQXJncygnc291cmNlJykucmV0dXJucygnc291cmNlcycpO1xuICAgICAgKGF3YWl0IGRyaXZlci5nZXRQYWdlU291cmNlKCkpLnNob3VsZC5iZS5lcXVhbCgnc291cmNlcycpO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ2JhY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCBwcmVzcyBiYWNrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlci5ib290c3RyYXAsICdzZW5kQWN0aW9uJyk7XG4gICAgICBhd2FpdCBkcml2ZXIuYmFjaygpO1xuICAgICAgZHJpdmVyLmJvb3RzdHJhcC5zZW5kQWN0aW9uLmNhbGxlZFdpdGhFeGFjdGx5KCdwcmVzc0JhY2snKS5zaG91bGQuYmUudHJ1ZTtcbiAgICB9KTtcbiAgfSk7XG4gIGRlc2NyaWJlKCdpc0tleWJvYXJkU2hvd24nLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdHJ1ZSBpZiB0aGUga2V5Ym9hcmQgaXMgc2hvd24nLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBkcml2ZXIuYWRiLmlzU29mdEtleWJvYXJkUHJlc2VudCA9ICgpID0+IHsgcmV0dXJuIHtpc0tleWJvYXJkU2hvd246IHRydWUsIGNhbkNsb3NlS2V5Ym9hcmQ6IHRydWV9OyB9O1xuICAgICAgKGF3YWl0IGRyaXZlci5pc0tleWJvYXJkU2hvd24oKSkuc2hvdWxkLmVxdWFsKHRydWUpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGZhbHNlIGlmIHRoZSBrZXlib2FyZCBpcyBub3Qgc2hvd24nLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBkcml2ZXIuYWRiLmlzU29mdEtleWJvYXJkUHJlc2VudCA9ICgpID0+IHsgcmV0dXJuIHtpc0tleWJvYXJkU2hvd246IGZhbHNlLCBjYW5DbG9zZUtleWJvYXJkOiB0cnVlfTsgfTtcbiAgICAgIChhd2FpdCBkcml2ZXIuaXNLZXlib2FyZFNob3duKCkpLnNob3VsZC5lcXVhbChmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xuICBkZXNjcmliZSgnaGlkZUtleWJvYXJkJywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgaGlkZSBrZXlib2FyZCB2aWEgYmFjayBjb21tYW5kJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlciwgJ2JhY2snKTtcbiAgICAgIGRyaXZlci5hZGIuaXNTb2Z0S2V5Ym9hcmRQcmVzZW50ID0gKCkgPT4geyByZXR1cm4ge2lzS2V5Ym9hcmRTaG93bjogdHJ1ZSwgY2FuQ2xvc2VLZXlib2FyZDogdHJ1ZX07IH07XG4gICAgICBhd2FpdCBkcml2ZXIuaGlkZUtleWJvYXJkKCk7XG4gICAgICBkcml2ZXIuYmFjay5jYWxsZWRPbmNlLnNob3VsZC5iZS50cnVlO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgbm90IGNhbGwgYmFjayBjb21tYW5kIGlmIGNhblxcJ3QgY2xvc2Uga2V5Ym9hcmQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLCAnYmFjaycpO1xuICAgICAgZHJpdmVyLmFkYi5pc1NvZnRLZXlib2FyZFByZXNlbnQgPSAoKSA9PiB7IHJldHVybiB7aXNLZXlib2FyZFNob3duOiB0cnVlLCBjYW5DbG9zZUtleWJvYXJkOiBmYWxzZX07IH07XG4gICAgICBhd2FpdCBkcml2ZXIuaGlkZUtleWJvYXJkKCk7XG4gICAgICBkcml2ZXIuYmFjay5ub3RDYWxsZWQuc2hvdWxkLmJlLnRydWU7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBhbiBlcnJvciBpZiBubyBrZXlib2FyZCBpcyBwcmVzZW50JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgZHJpdmVyLmFkYi5pc1NvZnRLZXlib2FyZFByZXNlbnQgPSAoKSA9PiB7IHJldHVybiBmYWxzZTsgfTtcbiAgICAgIGF3YWl0IGRyaXZlci5oaWRlS2V5Ym9hcmQoKS5zaG91bGQuYmUucmVqZWN0ZWRXaXRoKC9ub3QgcHJlc2VudC8pO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ29wZW5TZXR0aW5nc0FjdGl2aXR5JywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgb3BlbiBzZXR0aW5ncyBhY3Rpdml0eScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIHNhbmRib3guc3R1Yihkcml2ZXIuYWRiLCAnZ2V0Rm9jdXNlZFBhY2thZ2VBbmRBY3Rpdml0eScpXG4gICAgICAgIC5yZXR1cm5zKHthcHBQYWNrYWdlOiAncGtnJywgYXBwQWN0aXZpdHk6ICdhY3QnfSk7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmFkYiwgJ3NoZWxsJyk7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmFkYiwgJ3dhaXRGb3JOb3RBY3Rpdml0eScpO1xuICAgICAgYXdhaXQgZHJpdmVyLm9wZW5TZXR0aW5nc0FjdGl2aXR5KCdzZXQxJyk7XG4gICAgICBkcml2ZXIuYWRiLnNoZWxsLmNhbGxlZFdpdGhFeGFjdGx5KFsnYW0nLCAnc3RhcnQnLCAnLWEnLCAnYW5kcm9pZC5zZXR0aW5ncy5zZXQxJ10pXG4gICAgICAgIC5zaG91bGQuYmUudHJ1ZTtcbiAgICAgIGRyaXZlci5hZGIud2FpdEZvck5vdEFjdGl2aXR5LmNhbGxlZFdpdGhFeGFjdGx5KCdwa2cnLCAnYWN0JywgNTAwMClcbiAgICAgICAgLnNob3VsZC5iZS50cnVlO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ2dldFdpbmRvd1NpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCBnZXQgd2luZG93IHNpemUnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmJvb3RzdHJhcCwgJ3NlbmRBY3Rpb24nKVxuICAgICAgICAud2l0aEFyZ3MoJ2dldERldmljZVNpemUnKS5yZXR1cm5zKCdzaXplJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFdpbmRvd1NpemUoKSkuc2hvdWxkLmJlLmVxdWFsKCdzaXplJyk7XG4gICAgfSk7XG4gIH0pO1xuICBkZXNjcmliZSgnZ2V0V2luZG93UmVjdCcsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIGdldCB3aW5kb3cgc2l6ZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIHNhbmRib3guc3R1Yihkcml2ZXIuYm9vdHN0cmFwLCAnc2VuZEFjdGlvbicpXG4gICAgICAgIC53aXRoQXJncygnZ2V0RGV2aWNlU2l6ZScpLnJldHVybnMoe3dpZHRoOiAzMDAsIGhlaWdodDogNDAwfSk7XG4gICAgICBjb25zdCByZWN0ID0gYXdhaXQgZHJpdmVyLmdldFdpbmRvd1JlY3QoKTtcbiAgICAgIHJlY3Qud2lkdGguc2hvdWxkLmJlLmVxdWFsKDMwMCk7XG4gICAgICByZWN0LmhlaWdodC5zaG91bGQuYmUuZXF1YWwoNDAwKTtcbiAgICAgIHJlY3QueC5zaG91bGQuYmUuZXF1YWwoMCk7XG4gICAgICByZWN0Lnkuc2hvdWxkLmJlLmVxdWFsKDApO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ2dldEN1cnJlbnRBY3Rpdml0eScsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIGdldCBjdXJyZW50IGFjdGl2aXR5JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlci5hZGIsICdnZXRGb2N1c2VkUGFja2FnZUFuZEFjdGl2aXR5JylcbiAgICAgICAgLnJldHVybnMoe2FwcEFjdGl2aXR5OiAnYWN0J30pO1xuICAgICAgYXdhaXQgZHJpdmVyLmdldEN1cnJlbnRBY3Rpdml0eSgpLnNob3VsZC5ldmVudHVhbGx5LmJlLmVxdWFsKCdhY3QnKTtcbiAgICB9KTtcbiAgfSk7XG4gIGRlc2NyaWJlKCdnZXRDdXJyZW50UGFja2FnZScsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIGdldCBjdXJyZW50IGFjdGl2aXR5JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlci5hZGIsICdnZXRGb2N1c2VkUGFja2FnZUFuZEFjdGl2aXR5JylcbiAgICAgICAgLnJldHVybnMoe2FwcFBhY2thZ2U6ICdwa2cnfSk7XG4gICAgICBhd2FpdCBkcml2ZXIuZ2V0Q3VycmVudFBhY2thZ2UoKS5zaG91bGQuZXZlbnR1YWxseS5lcXVhbCgncGtnJyk7XG4gICAgfSk7XG4gIH0pO1xuICBkZXNjcmliZSgnaXNBcHBJbnN0YWxsZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdHJ1ZSBpZiBhcHAgaXMgaW5zdGFsbGVkJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlci5hZGIsICdpc0FwcEluc3RhbGxlZCcpLndpdGhBcmdzKCdwa2cnKS5yZXR1cm5zKHRydWUpO1xuICAgICAgKGF3YWl0IGRyaXZlci5pc0FwcEluc3RhbGxlZCgncGtnJykpLnNob3VsZC5iZS50cnVlO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ3JlbW92ZUFwcCcsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIHJlbW92ZSBhcHAnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmFkYiwgJ3VuaW5zdGFsbEFwaycpLndpdGhBcmdzKCdwa2cnKS5yZXR1cm5zKHRydWUpO1xuICAgICAgKGF3YWl0IGRyaXZlci5yZW1vdmVBcHAoJ3BrZycpKS5zaG91bGQuYmUudHJ1ZTtcbiAgICB9KTtcbiAgfSk7XG4gIGRlc2NyaWJlKCdpbnN0YWxsQXBwJywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgaW5zdGFsbCBhcHAnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgYXBwID0gJ2FwcC5hcGsnO1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlci5oZWxwZXJzLCAnY29uZmlndXJlQXBwJykud2l0aEFyZ3MoYXBwLCAnLmFwaycpXG4gICAgICAgIC5yZXR1cm5zKGFwcCk7XG4gICAgICBzYW5kYm94LnN0dWIoZnMsICdyaW1yYWYnKS5yZXR1cm5zKCk7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmFkYiwgJ2luc3RhbGwnKS5yZXR1cm5zKHRydWUpO1xuICAgICAgYXdhaXQgZHJpdmVyLmluc3RhbGxBcHAoYXBwKTtcbiAgICAgIGRyaXZlci5oZWxwZXJzLmNvbmZpZ3VyZUFwcC5jYWxsZWRPbmNlLnNob3VsZC5iZS50cnVlO1xuICAgICAgZnMucmltcmFmLm5vdENhbGxlZC5zaG91bGQuYmUudHJ1ZTtcbiAgICAgIGRyaXZlci5hZGIuaW5zdGFsbC5jYWxsZWRPbmNlLnNob3VsZC5iZS50cnVlO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdGhyb3cgYW4gZXJyb3IgaWYgQVBLIGRvZXMgbm90IGV4aXN0JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgYXdhaXQgZHJpdmVyLmluc3RhbGxBcHAoJ25vbi9leGlzdGVudC9hcHAuYXBrJykuc2hvdWxkLmJlXG4gICAgICAgIC5yZWplY3RlZFdpdGgoL2RvZXMgbm90IGV4aXN0IG9yIGlzIG5vdCBhY2Nlc3NpYmxlLyk7XG4gICAgfSk7XG4gIH0pO1xuICBkZXNjcmliZSgnYmFja2dyb3VuZCcsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIGJyaW5nIGFwcCB0byBiYWNrZ3JvdW5kIGFuZCBiYWNrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgYXBwUGFja2FnZSA9ICd3cGtnJztcbiAgICAgIGNvbnN0IGFwcEFjdGl2aXR5ID0gJ3dhY3YnO1xuICAgICAgZHJpdmVyLm9wdHMgPSB7YXBwUGFja2FnZSwgYXBwQWN0aXZpdHksIGludGVudEFjdGlvbjogJ2FjdCcsXG4gICAgICAgICAgICAgICAgICAgICBpbnRlbnRDYXRlZ29yeTogJ2NhdCcsIGludGVudEZsYWdzOiAnZmxncycsXG4gICAgICAgICAgICAgICAgICAgICBvcHRpb25hbEludGVudEFyZ3VtZW50czogJ29wdCd9O1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlci5hZGIsICdnb1RvSG9tZScpO1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlci5hZGIsICdnZXRGb2N1c2VkUGFja2FnZUFuZEFjdGl2aXR5JylcbiAgICAgICAgLnJldHVybnMoe2FwcFBhY2thZ2UsIGFwcEFjdGl2aXR5fSk7XG4gICAgICBzYW5kYm94LnN0dWIoQiwgJ2RlbGF5Jyk7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmFkYiwgJ3N0YXJ0QXBwJyk7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLCAnYWN0aXZhdGVBcHAnKTtcbiAgICAgIGF3YWl0IGRyaXZlci5iYWNrZ3JvdW5kKDEwKTtcbiAgICAgIGRyaXZlci5hZGIuZ2V0Rm9jdXNlZFBhY2thZ2VBbmRBY3Rpdml0eS5jYWxsZWRPbmNlLnNob3VsZC5iZS50cnVlO1xuICAgICAgZHJpdmVyLmFkYi5nb1RvSG9tZS5jYWxsZWRPbmNlLnNob3VsZC5iZS50cnVlO1xuICAgICAgQi5kZWxheS5jYWxsZWRXaXRoRXhhY3RseSgxMDAwMCkuc2hvdWxkLmJlLnRydWU7XG4gICAgICBkcml2ZXIuYWN0aXZhdGVBcHAuY2FsbGVkV2l0aEV4YWN0bHkoYXBwUGFja2FnZSkuc2hvdWxkLmJlLnRydWU7XG4gICAgICBkcml2ZXIuYWRiLnN0YXJ0QXBwLm5vdENhbGxlZC5zaG91bGQuYmUudHJ1ZTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIGJyaW5nIGFwcCB0byBiYWNrZ3JvdW5kIGFuZCBiYWNrIGlmIHN0YXJ0ZWQgYWZ0ZXIgc2Vzc2lvbiBpbml0JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgYXBwUGFja2FnZSA9ICduZXdwa2cnO1xuICAgICAgY29uc3QgYXBwQWN0aXZpdHkgPSAnbmV3YWN2JztcbiAgICAgIGRyaXZlci5vcHRzID0ge2FwcFBhY2thZ2U6ICdwa2cnLCBhcHBBY3Rpdml0eTogJ2FjdicsIGludGVudEFjdGlvbjogJ2FjdCcsXG4gICAgICAgICAgICAgICAgICAgICBpbnRlbnRDYXRlZ29yeTogJ2NhdCcsIGludGVudEZsYWdzOiAnZmxncycsXG4gICAgICAgICAgICAgICAgICAgICBvcHRpb25hbEludGVudEFyZ3VtZW50czogJ29wdCd9O1xuICAgICAgbGV0IHBhcmFtcyA9IHtwa2c6IGFwcFBhY2thZ2UsIGFjdGl2aXR5OiBhcHBBY3Rpdml0eSwgYWN0aW9uOiAnYWN0JywgY2F0ZWdvcnk6ICdjYXQnLFxuICAgICAgICAgICAgICAgICAgICBmbGFnczogJ2ZsZ3MnLCB3YWl0UGtnOiAnd3BrZycsIHdhaXRBY3Rpdml0eTogJ3dhY3YnLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbEludGVudEFyZ3VtZW50czogJ29wdCcsIHN0b3BBcHA6IGZhbHNlfTtcbiAgICAgIGRyaXZlci5fY2FjaGVkQWN0aXZpdHlBcmdzID0ge1tgJHthcHBQYWNrYWdlfS8ke2FwcEFjdGl2aXR5fWBdOiBwYXJhbXN9O1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlci5hZGIsICdnb1RvSG9tZScpO1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlci5hZGIsICdnZXRGb2N1c2VkUGFja2FnZUFuZEFjdGl2aXR5JylcbiAgICAgICAgLnJldHVybnMoe2FwcFBhY2thZ2UsIGFwcEFjdGl2aXR5fSk7XG4gICAgICBzYW5kYm94LnN0dWIoQiwgJ2RlbGF5Jyk7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmFkYiwgJ3N0YXJ0QXBwJyk7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLCAnYWN0aXZhdGVBcHAnKTtcbiAgICAgIGF3YWl0IGRyaXZlci5iYWNrZ3JvdW5kKDEwKTtcbiAgICAgIGRyaXZlci5hZGIuZ2V0Rm9jdXNlZFBhY2thZ2VBbmRBY3Rpdml0eS5jYWxsZWRPbmNlLnNob3VsZC5iZS50cnVlO1xuICAgICAgZHJpdmVyLmFkYi5nb1RvSG9tZS5jYWxsZWRPbmNlLnNob3VsZC5iZS50cnVlO1xuICAgICAgQi5kZWxheS5jYWxsZWRXaXRoRXhhY3RseSgxMDAwMCkuc2hvdWxkLmJlLnRydWU7XG4gICAgICBkcml2ZXIuYWRiLnN0YXJ0QXBwLmNhbGxlZFdpdGhFeGFjdGx5KHBhcmFtcykuc2hvdWxkLmJlLnRydWU7XG4gICAgICBkcml2ZXIuYWN0aXZhdGVBcHAubm90Q2FsbGVkLnNob3VsZC5iZS50cnVlO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgYnJpbmcgYXBwIHRvIGJhY2tncm91bmQgYW5kIGJhY2sgaWYgd2FpdGluZyBmb3Igb3RoZXIgcGtnIC8gYWN0aXZpdHknLCBhc3luYyBmdW5jdGlvbiAoKSB7IC8vZXNsaW50LWRpc2FibGUtbGluZVxuICAgICAgY29uc3QgYXBwUGFja2FnZSA9ICdzb21lcGtnJztcbiAgICAgIGNvbnN0IGFwcEFjdGl2aXR5ID0gJ3NvbWVhY3YnO1xuICAgICAgY29uc3QgYXBwV2FpdFBhY2thZ2UgPSAnc29tZXdhaXRwa2cnO1xuICAgICAgY29uc3QgYXBwV2FpdEFjdGl2aXR5ID0gJ3NvbWV3YWl0YWN2JztcbiAgICAgIGRyaXZlci5vcHRzID0ge2FwcFBhY2thZ2UsIGFwcEFjdGl2aXR5LCBhcHBXYWl0UGFja2FnZSwgYXBwV2FpdEFjdGl2aXR5LFxuICAgICAgICAgICAgICAgICAgICAgaW50ZW50QWN0aW9uOiAnYWN0JywgaW50ZW50Q2F0ZWdvcnk6ICdjYXQnLFxuICAgICAgICAgICAgICAgICAgICAgaW50ZW50RmxhZ3M6ICdmbGdzJywgb3B0aW9uYWxJbnRlbnRBcmd1bWVudHM6ICdvcHQnLFxuICAgICAgICAgICAgICAgICAgICAgc3RvcEFwcDogZmFsc2V9O1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlci5hZGIsICdnb1RvSG9tZScpO1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlci5hZGIsICdnZXRGb2N1c2VkUGFja2FnZUFuZEFjdGl2aXR5JylcbiAgICAgICAgLnJldHVybnMoe2FwcFBhY2thZ2U6IGFwcFdhaXRQYWNrYWdlLCBhcHBBY3Rpdml0eTogYXBwV2FpdEFjdGl2aXR5fSk7XG4gICAgICBzYW5kYm94LnN0dWIoQiwgJ2RlbGF5Jyk7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmFkYiwgJ3N0YXJ0QXBwJyk7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLCAnYWN0aXZhdGVBcHAnKTtcbiAgICAgIGF3YWl0IGRyaXZlci5iYWNrZ3JvdW5kKDEwKTtcbiAgICAgIGRyaXZlci5hZGIuZ2V0Rm9jdXNlZFBhY2thZ2VBbmRBY3Rpdml0eS5jYWxsZWRPbmNlLnNob3VsZC5iZS50cnVlO1xuICAgICAgZHJpdmVyLmFkYi5nb1RvSG9tZS5jYWxsZWRPbmNlLnNob3VsZC5iZS50cnVlO1xuICAgICAgQi5kZWxheS5jYWxsZWRXaXRoRXhhY3RseSgxMDAwMCkuc2hvdWxkLmJlLnRydWU7XG4gICAgICBkcml2ZXIuYWN0aXZhdGVBcHAuY2FsbGVkV2l0aEV4YWN0bHkoYXBwV2FpdFBhY2thZ2UpLnNob3VsZC5iZS50cnVlO1xuICAgICAgZHJpdmVyLmFkYi5zdGFydEFwcC5ub3RDYWxsZWQuc2hvdWxkLmJlLnRydWU7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBub3QgYnJpbmcgYXBwIGJhY2sgaWYgc2Vjb25kcyBhcmUgbmVnYXRpdmUnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmFkYiwgJ2dvVG9Ib21lJyk7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmFkYiwgJ3N0YXJ0QXBwJyk7XG4gICAgICBhd2FpdCBkcml2ZXIuYmFja2dyb3VuZCgtMSk7XG4gICAgICBkcml2ZXIuYWRiLmdvVG9Ib21lLmNhbGxlZE9uY2Uuc2hvdWxkLmJlLnRydWU7XG4gICAgICBkcml2ZXIuYWRiLnN0YXJ0QXBwLm5vdENhbGxlZC5zaG91bGQuYmUudHJ1ZTtcbiAgICB9KTtcbiAgfSk7XG4gIGRlc2NyaWJlKCdnZXRTdHJpbmdzJywgd2l0aE1vY2tzKHtoZWxwZXJzfSwgKG1vY2tzKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYXBwIHN0cmluZ3MnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBkcml2ZXIuYm9vdHN0cmFwLnNlbmRBY3Rpb24gPSAoKSA9PiB7IHJldHVybiAnJzsgfTtcbiAgICAgIG1vY2tzLmhlbHBlcnMuZXhwZWN0cyhcInB1c2hTdHJpbmdzXCIpXG4gICAgICAgICAgLnJldHVybnMoe3Rlc3Q6ICdlbl92YWx1ZSd9KTtcbiAgICAgIGxldCBzdHJpbmdzID0gYXdhaXQgZHJpdmVyLmdldFN0cmluZ3MoJ2VuJyk7XG4gICAgICBzdHJpbmdzLnRlc3Quc2hvdWxkLmVxdWFsKCdlbl92YWx1ZScpO1xuICAgICAgbW9ja3MuaGVscGVycy52ZXJpZnkoKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBjYWNoZWQgYXBwIHN0cmluZ3MgZm9yIHRoZSBzcGVjaWZpZWQgbGFuZ3VhZ2UnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBkcml2ZXIuYWRiLmdldERldmljZUxhbmd1YWdlID0gKCkgPT4geyByZXR1cm4gJ2VuJzsgfTtcbiAgICAgIGRyaXZlci5hcGtTdHJpbmdzLmVuID0ge3Rlc3Q6ICdlbl92YWx1ZSd9O1xuICAgICAgZHJpdmVyLmFwa1N0cmluZ3MuZnIgPSB7dGVzdDogJ2ZyX3ZhbHVlJ307XG4gICAgICBsZXQgc3RyaW5ncyA9IGF3YWl0IGRyaXZlci5nZXRTdHJpbmdzKCdmcicpO1xuICAgICAgc3RyaW5ncy50ZXN0LnNob3VsZC5lcXVhbCgnZnJfdmFsdWUnKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBjYWNoZWQgYXBwIHN0cmluZ3MgZm9yIHRoZSBkZXZpY2UgbGFuZ3VhZ2UnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBkcml2ZXIuYWRiLmdldERldmljZUxhbmd1YWdlID0gKCkgPT4geyByZXR1cm4gJ2VuJzsgfTtcbiAgICAgIGRyaXZlci5hcGtTdHJpbmdzLmVuID0ge3Rlc3Q6ICdlbl92YWx1ZSd9O1xuICAgICAgZHJpdmVyLmFwa1N0cmluZ3MuZnIgPSB7dGVzdDogJ2ZyX3ZhbHVlJ307XG4gICAgICBsZXQgc3RyaW5ncyA9IGF3YWl0IGRyaXZlci5nZXRTdHJpbmdzKCk7XG4gICAgICBzdHJpbmdzLnRlc3Quc2hvdWxkLmVxdWFsKCdlbl92YWx1ZScpO1xuICAgIH0pO1xuICB9KSk7XG4gIGRlc2NyaWJlKCdsYXVuY2hBcHAnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCBpbml0IGFuZCBzdGFydCBhcHAnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLCAnaW5pdEFVVCcpO1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlciwgJ3N0YXJ0QVVUJyk7XG4gICAgICBhd2FpdCBkcml2ZXIubGF1bmNoQXBwKCk7XG4gICAgICBkcml2ZXIuaW5pdEFVVC5jYWxsZWRPbmNlLnNob3VsZC5iZS50cnVlO1xuICAgICAgZHJpdmVyLnN0YXJ0QVVULmNhbGxlZE9uY2Uuc2hvdWxkLmJlLnRydWU7XG4gICAgfSk7XG4gIH0pO1xuICBkZXNjcmliZSgnc3RhcnRBY3Rpdml0eScsIGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgcGFyYW1zO1xuICAgIGJlZm9yZUVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgcGFyYW1zID0ge3BrZzogJ3BrZycsIGFjdGl2aXR5OiAnYWN0Jywgd2FpdFBrZzogJ3dwa2cnLCB3YWl0QWN0aXZpdHk6ICd3YWN0JyxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICdhY3QnLCBjYXRlZ29yeTogJ2NhdCcsIGZsYWdzOiAnZmxncycsIG9wdGlvbmFsSW50ZW50QXJndW1lbnRzOiAnb3B0J307XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmFkYiwgJ3N0YXJ0QXBwJyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBzdGFydCBhY3Rpdml0eScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIHBhcmFtcy5vcHRpb25hbEludGVudEFyZ3VtZW50cyA9ICdvcHQnO1xuICAgICAgcGFyYW1zLnN0b3BBcHAgPSBmYWxzZTtcbiAgICAgIGF3YWl0IGRyaXZlci5zdGFydEFjdGl2aXR5KCdwa2cnLCAnYWN0JywgJ3dwa2cnLCAnd2FjdCcsICdhY3QnLFxuICAgICAgICAnY2F0JywgJ2ZsZ3MnLCAnb3B0JywgdHJ1ZSk7XG4gICAgICBkcml2ZXIuYWRiLnN0YXJ0QXBwLmNhbGxlZFdpdGhFeGFjdGx5KHBhcmFtcykuc2hvdWxkLmJlLnRydWU7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCB1c2UgZG9udFN0b3BBcHBPblJlc2V0IGZyb20gb3B0cyBpZiBpdCBpcyBub3QgcGFzc2VkIGFzIHBhcmFtJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgZHJpdmVyLm9wdHMuZG9udFN0b3BBcHBPblJlc2V0ID0gdHJ1ZTtcbiAgICAgIHBhcmFtcy5zdG9wQXBwID0gZmFsc2U7XG4gICAgICBhd2FpdCBkcml2ZXIuc3RhcnRBY3Rpdml0eSgncGtnJywgJ2FjdCcsICd3cGtnJywgJ3dhY3QnLCAnYWN0JywgJ2NhdCcsICdmbGdzJywgJ29wdCcpO1xuICAgICAgZHJpdmVyLmFkYi5zdGFydEFwcC5jYWxsZWRXaXRoRXhhY3RseShwYXJhbXMpLnNob3VsZC5iZS50cnVlO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdXNlIGFwcFBhY2thZ2UgYW5kIGFwcEFjdGl2aXR5IGlmIGFwcFdhaXRQYWNrYWdlIGFuZCBhcHBXYWl0QWN0aXZpdHkgYXJlIHVuZGVmaW5lZCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIHBhcmFtcy53YWl0UGtnID0gJ3BrZyc7XG4gICAgICBwYXJhbXMud2FpdEFjdGl2aXR5ID0gJ2FjdCc7XG4gICAgICBwYXJhbXMuc3RvcEFwcCA9IHRydWU7XG4gICAgICBhd2FpdCBkcml2ZXIuc3RhcnRBY3Rpdml0eSgncGtnJywgJ2FjdCcsIG51bGwsIG51bGwsICdhY3QnLCAnY2F0JywgJ2ZsZ3MnLCAnb3B0JywgZmFsc2UpO1xuICAgICAgZHJpdmVyLmFkYi5zdGFydEFwcC5jYWxsZWRXaXRoRXhhY3RseShwYXJhbXMpLnNob3VsZC5iZS50cnVlO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ3Jlc2V0JywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgcmVzZXQgYXBwIHZpYSByZWluc3RhbGwgaWYgZnVsbFJlc2V0IGlzIHRydWUnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBkcml2ZXIub3B0cy5mdWxsUmVzZXQgPSB0cnVlO1xuICAgICAgZHJpdmVyLm9wdHMuYXBwUGFja2FnZSA9ICdwa2cnO1xuICAgICAgc2FuZGJveC5zdHViKGRyaXZlciwgJ3N0YXJ0QVVUJykucmV0dXJucygnYXV0Jyk7XG4gICAgICBzYW5kYm94LnN0dWIoaGVscGVycywgJ3Jlc2V0QXBwJykucmV0dXJucyh1bmRlZmluZWQpO1xuICAgICAgYXdhaXQgZHJpdmVyLnJlc2V0KCkuc2hvdWxkLmV2ZW50dWFsbHkuYmUuZXF1YWwoJ2F1dCcpO1xuICAgICAgaGVscGVycy5yZXNldEFwcC5jYWxsZWRXaXRoKGRyaXZlci5hZGIpLnNob3VsZC5iZS50cnVlO1xuICAgICAgZHJpdmVyLnN0YXJ0QVVULmNhbGxlZE9uY2Uuc2hvdWxkLmJlLnRydWU7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBkbyBmYXN0IHJlc2V0IGlmIGZ1bGxSZXNldCBpcyBmYWxzZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGRyaXZlci5vcHRzLmZ1bGxSZXNldCA9IGZhbHNlO1xuICAgICAgZHJpdmVyLm9wdHMuYXBwUGFja2FnZSA9ICdwa2cnO1xuICAgICAgc2FuZGJveC5zdHViKGhlbHBlcnMsICdyZXNldEFwcCcpLnJldHVybnModW5kZWZpbmVkKTtcbiAgICAgIHNhbmRib3guc3R1Yihkcml2ZXIsICdzdGFydEFVVCcpLnJldHVybnMoJ2F1dCcpO1xuICAgICAgYXdhaXQgZHJpdmVyLnJlc2V0KCkuc2hvdWxkLmV2ZW50dWFsbHkuYmUuZXF1YWwoJ2F1dCcpO1xuICAgICAgaGVscGVycy5yZXNldEFwcC5jYWxsZWRXaXRoKGRyaXZlci5hZGIpLnNob3VsZC5iZS50cnVlO1xuICAgICAgZHJpdmVyLnN0YXJ0QVVULmNhbGxlZE9uY2Uuc2hvdWxkLmJlLnRydWU7XG4gICAgICBleHBlY3QoZHJpdmVyLmN1ckNvbnRleHQpLnRvLmVxbCgnTkFUSVZFX0FQUCcpO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ3N0YXJ0QVVUJywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgc3RhcnQgQVVUJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgZHJpdmVyLm9wdHMgPSB7XG4gICAgICAgIGFwcFBhY2thZ2U6ICdwa2cnLFxuICAgICAgICBhcHBBY3Rpdml0eTogJ2FjdCcsXG4gICAgICAgIGludGVudEFjdGlvbjogJ2FjdG4nLFxuICAgICAgICBpbnRlbnRDYXRlZ29yeTogJ2NhdCcsXG4gICAgICAgIGludGVudEZsYWdzOiAnZmxncycsXG4gICAgICAgIGFwcFdhaXRQYWNrYWdlOiAnd3BrZycsXG4gICAgICAgIGFwcFdhaXRBY3Rpdml0eTogJ3dhY3QnLFxuICAgICAgICBhcHBXYWl0RHVyYXRpb246ICd3ZHVyJyxcbiAgICAgICAgb3B0aW9uYWxJbnRlbnRBcmd1bWVudHM6ICdvcHQnLFxuICAgICAgICB1c2VyUHJvZmlsZTogMVxuICAgICAgfTtcbiAgICAgIGxldCBwYXJhbXMgPSB7XG4gICAgICAgIHBrZzogJ3BrZycsXG4gICAgICAgIGFjdGl2aXR5OiAnYWN0JyxcbiAgICAgICAgYWN0aW9uOiAnYWN0bicsXG4gICAgICAgIGNhdGVnb3J5OiAnY2F0JyxcbiAgICAgICAgZmxhZ3M6ICdmbGdzJyxcbiAgICAgICAgd2FpdFBrZzogJ3dwa2cnLFxuICAgICAgICB3YWl0QWN0aXZpdHk6ICd3YWN0JyxcbiAgICAgICAgd2FpdER1cmF0aW9uOiAnd2R1cicsXG4gICAgICAgIG9wdGlvbmFsSW50ZW50QXJndW1lbnRzOiAnb3B0JyxcbiAgICAgICAgc3RvcEFwcDogZmFsc2UsXG4gICAgICAgIHVzZXI6IDFcbiAgICAgIH07XG4gICAgICBkcml2ZXIub3B0cy5kb250U3RvcEFwcE9uUmVzZXQgPSB0cnVlO1xuICAgICAgcGFyYW1zLnN0b3BBcHAgPSBmYWxzZTtcbiAgICAgIHNhbmRib3guc3R1Yihkcml2ZXIuYWRiLCAnc3RhcnRBcHAnKTtcbiAgICAgIGF3YWl0IGRyaXZlci5zdGFydEFVVCgpO1xuICAgICAgZHJpdmVyLmFkYi5zdGFydEFwcC5jYWxsZWRXaXRoRXhhY3RseShwYXJhbXMpLnNob3VsZC5iZS50cnVlO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ3NldFVybCcsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIHNldCB1cmwnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBkcml2ZXIub3B0cyA9IHthcHBQYWNrYWdlOiAncGtnJ307XG4gICAgICBzYW5kYm94LnN0dWIoZHJpdmVyLmFkYiwgJ3N0YXJ0VXJpJyk7XG4gICAgICBhd2FpdCBkcml2ZXIuc2V0VXJsKCd1cmwnKTtcbiAgICAgIGRyaXZlci5hZGIuc3RhcnRVcmkuY2FsbGVkV2l0aEV4YWN0bHkoJ3VybCcsICdwa2cnKS5zaG91bGQuYmUudHJ1ZTtcbiAgICB9KTtcbiAgfSk7XG4gIGRlc2NyaWJlKCdjbG9zZUFwcCcsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIGNsb3NlIGFwcCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGRyaXZlci5vcHRzID0ge2FwcFBhY2thZ2U6ICdwa2cnfTtcbiAgICAgIHNhbmRib3guc3R1Yihkcml2ZXIuYWRiLCAnZm9yY2VTdG9wJyk7XG4gICAgICBhd2FpdCBkcml2ZXIuY2xvc2VBcHAoKTtcbiAgICAgIGRyaXZlci5hZGIuZm9yY2VTdG9wLmNhbGxlZFdpdGhFeGFjdGx5KCdwa2cnKS5zaG91bGQuYmUudHJ1ZTtcbiAgICB9KTtcbiAgfSk7XG4gIGRlc2NyaWJlKCdnZXREaXNwbGF5RGVuc2l0eScsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB0aGUgZGlzcGxheSBkZW5zaXR5IG9mIGEgZGV2aWNlJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgZHJpdmVyLmFkYi5zaGVsbCA9ICgpID0+IHsgcmV0dXJuICcxMjMnOyB9O1xuICAgICAgKGF3YWl0IGRyaXZlci5nZXREaXNwbGF5RGVuc2l0eSgpKS5zaG91bGQuZXF1YWwoMTIzKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB0aGUgZGlzcGxheSBkZW5zaXR5IG9mIGFuIGVtdWxhdG9yJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgZHJpdmVyLmFkYi5zaGVsbCA9IChjbWQpID0+IHtcbiAgICAgICAgbGV0IGpvaW5lZENtZCA9IGNtZC5qb2luKCcgJyk7XG4gICAgICAgIGlmIChqb2luZWRDbWQuaW5kZXhPZigncm8uc2YnKSAhPT0gLTEpIHtcbiAgICAgICAgICAvLyBkZXZpY2UgcHJvcGVydHkgbG9vayB1cFxuICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfSBlbHNlIGlmIChqb2luZWRDbWQuaW5kZXhPZigncWVtdS5zZicpICE9PSAtMSkge1xuICAgICAgICAgIC8vIGVtdWxhdG9yIHByb3BlcnR5IGxvb2sgdXBcbiAgICAgICAgICByZXR1cm4gJzQ1Nic7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZ2V0RGlzcGxheURlbnNpdHkoKSkuc2hvdWxkLmVxdWFsKDQ1Nik7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBhbiBlcnJvciBpZiB0aGUgZGlzcGxheSBkZW5zaXR5IHByb3BlcnR5IGNhblxcJ3QgYmUgZm91bmQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBkcml2ZXIuYWRiLnNoZWxsID0gKCkgPT4geyByZXR1cm4gJyc7IH07XG4gICAgICBhd2FpdCBkcml2ZXIuZ2V0RGlzcGxheURlbnNpdHkoKS5zaG91bGQuYmUucmVqZWN0ZWRXaXRoKC9GYWlsZWQgdG8gZ2V0IGRpc3BsYXkgZGVuc2l0eSBwcm9wZXJ0eS8pO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdGhyb3cgYW5kIGVycm9yIGlmIHRoZSBkaXNwbGF5IGRlbnNpdHkgaXMgbm90IGEgbnVtYmVyJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgZHJpdmVyLmFkYi5zaGVsbCA9ICgpID0+IHsgcmV0dXJuICdhYmMnOyB9O1xuICAgICAgYXdhaXQgZHJpdmVyLmdldERpc3BsYXlEZW5zaXR5KCkuc2hvdWxkLmJlLnJlamVjdGVkV2l0aCgvRmFpbGVkIHRvIGdldCBkaXNwbGF5IGRlbnNpdHkgcHJvcGVydHkvKTtcbiAgICB9KTtcbiAgfSk7XG4gIGRlc2NyaWJlKCdwYXJzZVN1cmZhY2VMaW5lJywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHZpc2libGUgdHJ1ZSBpZiB0aGUgc3VyZmFjZSBpcyB2aXNpYmxlJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgcGFyc2VTdXJmYWNlTGluZSgnc2hvd249dHJ1ZSByZWN0PTEgMSAxIDEnKS5zaG91bGQuYmUuZXFsKHtcbiAgICAgICAgdmlzaWJsZTogdHJ1ZSxcbiAgICAgICAgeDogMSxcbiAgICAgICAgeTogMSxcbiAgICAgICAgd2lkdGg6IDEsXG4gICAgICAgIGhlaWdodDogMVxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdmlzaWJsZSBmYWxzZSBpZiB0aGUgc3VyZmFjZSBpcyBub3QgdmlzaWJsZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIHBhcnNlU3VyZmFjZUxpbmUoJ3Nob3duPWZhbHNlIHJlY3Q9MSAxIDEgMScpLnNob3VsZC5iZS5lcWwoe1xuICAgICAgICB2aXNpYmxlOiBmYWxzZSxcbiAgICAgICAgeDogMSxcbiAgICAgICAgeTogMSxcbiAgICAgICAgd2lkdGg6IDEsXG4gICAgICAgIGhlaWdodDogMVxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdGhlIHBhcnNlZCBzdXJmYWNlIGJvdW5kcycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIHBhcnNlU3VyZmFjZUxpbmUoJ3Nob3duPXRydWUgcmVjdD0oMS4wLDIuMCkgMy4wIHggNC4wJykuc2hvdWxkLmJlLmVxbCh7XG4gICAgICAgIHZpc2libGU6IHRydWUsXG4gICAgICAgIHg6IDEsXG4gICAgICAgIHk6IDIsXG4gICAgICAgIHdpZHRoOiAzLFxuICAgICAgICBoZWlnaHQ6IDRcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICAvLyB0aGVzZSBhcmUgdXNlZCBmb3IgYm90aCBwYXJzZVdpbmRvd3MgYW5kIGdldFN5c3RlbUJhcnMgdGVzdHNcbiAgbGV0IHZhbGlkV2luZG93T3V0cHV0ID0gW1xuICAgICcgIFdpbmRvdyAjMSBEZXJwJyxcbiAgICAnICAgIHN0dWZmJyxcbiAgICAnICAgICAgU3VyZmFjZTogZGVycCBzaG93bj1mYWxzZSBsYWxhbGFsYSByZWN0PSg5LjAsOC4wKSA3LjAgeCA2LjAnLFxuICAgICcgICAgbW9yZSBzdHVmZicsXG4gICAgJyAgV2luZG93ICMyIFN0YXR1c0JhcicsXG4gICAgJyAgICBibGFoIGJsYWggYmxhaCcsXG4gICAgJyAgICAgIFN1cmZhY2U6IGJsYWggYmxhaCBzaG93bj10cnVlIGJsYWggYmxhaCByZWN0PSgxLjAsMi4wKSAzLjAgeCA0LjAnLFxuICAgICcgICAgYmxhaCBibGFoIGJsYWgnLFxuICAgICcgIFdpbmRvdyAjMyBOYXZpZ2F0aW9uQmFyJyxcbiAgICAnICAgIHdvbXAgd29tcCcsXG4gICAgJyAgICAgIFN1cmZhY2U6IGJsYWggYmxhaCBzaG93bj1mYWxzZSB3b21wIHdvbXAgcmVjdD0oNS4wLDYuMCkgNTAuMCB4IDYwLjAnLFxuICAgICcgICAgcXdlcnR5IGFzZCB6eGMnXG4gIF0uam9pbignXFxuJyk7XG4gIGxldCB2YWxpZFN5c3RlbUJhcnMgPSB7XG4gICAgc3RhdHVzQmFyOiB7dmlzaWJsZTogdHJ1ZSwgeDogMSwgeTogMiwgd2lkdGg6IDMsIGhlaWdodDogNH0sXG4gICAgbmF2aWdhdGlvbkJhcjoge3Zpc2libGU6IGZhbHNlLCB4OiA1LCB5OiA2LCB3aWR0aDogNTAsIGhlaWdodDogNjB9XG4gIH07XG5cbiAgZGVzY3JpYmUoJ3BhcnNlV2luZG93cycsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIHRocm93IGFuIGVycm9yIGlmIHRoZSBzdGF0dXMgYmFyIGluZm8gd2FzblxcJ3QgZm91bmQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBleHBlY3QoKCkgPT4geyBwYXJzZVdpbmRvd3MoJycpOyB9KVxuICAgICAgICAudG8udGhyb3coRXJyb3IsIC9GYWlsZWQgdG8gcGFyc2Ugc3RhdHVzIGJhciBpbmZvcm1hdGlvbi4vKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHRocm93IGFuIGVycm9yIGlmIHRoZSBuYXZpZ2F0aW9uIGJhciBpbmZvIHdhc25cXCd0IGZvdW5kJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IHdpbmRvd091dHB1dCA9IFtcbiAgICAgICAgJyAgV2luZG93ICMxIFN0YXR1c0JhcicsXG4gICAgICAgICcgICAgYmxhaCBibGFoIGJsYWgnLFxuICAgICAgICAnICAgICAgU3VyZmFjZTogYmxhaCBibGFoIHNob3duPXRydWUgYmxhaCBibGFoIHJlY3Q9KDEuMCwyLjApIDMuMCB4IDQuMCcsXG4gICAgICAgICcgICAgYmxhaCBibGFoIGJsYWgnXG4gICAgICBdLmpvaW4oJ1xcbicpO1xuICAgICAgZXhwZWN0KCgpID0+IHsgcGFyc2VXaW5kb3dzKHdpbmRvd091dHB1dCk7IH0pXG4gICAgICAgIC50by50aHJvdyhFcnJvciwgL0ZhaWxlZCB0byBwYXJzZSBuYXZpZ2F0aW9uIGJhciBpbmZvcm1hdGlvbi4vKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBzdGF0dXMgYW5kIG5hdmlnYXRpb24gYmFyIGluZm8gd2hlbiBib3RoIGFyZSBnaXZlbicsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIHBhcnNlV2luZG93cyh2YWxpZFdpbmRvd091dHB1dCkuc2hvdWxkLmJlLmVxbCh2YWxpZFN5c3RlbUJhcnMpO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ2dldFN5c3RlbUJhcnMnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBhbiBlcnJvciBpZiB0aGVyZVxcJ3Mgbm8gd2luZG93IG1hbmFnZXIgb3V0cHV0JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgZHJpdmVyID0gbmV3IEFuZHJvaWREcml2ZXIoKTtcbiAgICAgIGRyaXZlci5hZGIgPSB7fTtcbiAgICAgIGRyaXZlci5hZGIuc2hlbGwgPSAoKSA9PiB7IHJldHVybiAnJzsgfTtcbiAgICAgIGF3YWl0IGRyaXZlci5nZXRTeXN0ZW1CYXJzKCkuc2hvdWxkLmJlLnJlamVjdGVkV2l0aCgvRGlkIG5vdCBnZXQgd2luZG93IG1hbmFnZXIgb3V0cHV0Li8pO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHRoZSBwYXJzZWQgc3lzdGVtIGJhciBpbmZvJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgZHJpdmVyID0gbmV3IEFuZHJvaWREcml2ZXIoKTtcbiAgICAgIGRyaXZlci5hZGIgPSB7fTtcbiAgICAgIGRyaXZlci5hZGIuc2hlbGwgPSAoKSA9PiB7IHJldHVybiB2YWxpZFdpbmRvd091dHB1dDsgfTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZ2V0U3lzdGVtQmFycygpKS5zaG91bGQuYmUuZXFsKHZhbGlkU3lzdGVtQmFycyk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uLy4uIn0=
